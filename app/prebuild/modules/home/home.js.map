{"version":3,"sources":["app/modules/home/home.js"],"names":[],"mappings":"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","file":"app/modules/home/home.js","sourcesContent":["'use strict';\n(function(){ // START IIFE\n\nangular.module('wxApp.modules.home', ['ngRoute','firebase', 'wxApp.coremodules.cookies', 'wxApp.coremodules.conversions', 'wxApp.datamodules.firebase', 'wxApp.coremodules.maps', 'wxApp.coremodules.tools', 'wxApp.directivemodules.search', 'wxApp.directivemodules.footer', 'wxApp.directivemodules.alert'])\n \n// Declared route \n.config(['$routeProvider', function($routeProvider) {\n    $routeProvider.when('/home', {\n        templateUrl: 'modules/home/home.html'//,\n//        controller: 'HomeCtrl' (removed since the html was also referencing the controller causing it to happen twice)\n    });\n}])\n \n// Define controller, services, factories, providers, filters\n.controller('HomeController', HomeController)\n.service('FirebaseFeedService', FirebaseFeedService)\n.service('DrylineService', DrylineService)\n.filter('TemperatureFilter', TemperatureFilter)\n.filter('WindDirectionFilter', WindDirectionFilter);\n\n// Dependency injections to controller, services, factories, providers, filters\nHomeController.$inject =  ['$scope', 'FirebaseFeedService', 'DrylineService', 'CookiesService', 'MapsService', 'ConversionsService'];\nFirebaseFeedService.$inject = ['FirebaseDataService', 'MapsService'];\nDrylineService.$inject = ['ConversionsService', 'ToolsService'];\nTemperatureFilter.$inject = ['ConversionsService'];\nWindDirectionFilter.$inject = ['ConversionsService'];\n\n// -- Function defining HomeController\n// input : FirebaseFeedService\n// \t : scope\nfunction HomeController($scope, FirebaseFeedService, DrylineService, CookiesService, MapsService, ConversionsService) {\n\tvar self = this;\n\t// uses alert directive to set initial message and then clears it\n\tthis.alertMessage = \"Loading\";\n\tsetTimeout(function(){\n\t\t$scope.$apply(function(){\n\t\t\tself.alertMessage = \"\";\n\t\t});\n\t}, 2000);\n\n\t// initialization of default values\n\tthis.alertType = \"info\";\n\tthis.currentRegion = 'TX';\n\tthis.headers = ['Name','Temperature','Pressure','Humidity','Wind Speed','Wind Direction'];\n\tthis.sortOrderItems = ['+name', '+main.temp', '+main.pressure', '+main.humidity', '+wind.speed', '+wind.deg'];\n\tthis.sortOrder = this.sortOrderItems[0];\n\tthis.compare1 = undefined;\n\tthis.compare2 = undefined;\n\n\t// checks that cookie is set\n\t// output : boolean\n\tthis.testCookie = function(){\n\t\tif (CookiesService.getCookie('username') != ''){\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t};\n\n\t// check that there is a valid cookie and redirect to login if not\n\tif (this.testCookie()){\n\t\tFirebaseFeedService.feed($scope, self);\n\t} else {\n\t\tlocation = '#login';\t\n\t}\n\n\t// change region\n\t// - currentRegion which filters table\n\t// - redraws map\n\tthis.switchRegion = function(evt, region){\n\t\tevt.stopPropagation();\n\t\tself.currentRegion = region;\n\t\tself.message = \"\";\n\t\tif (self.compare1 != undefined){\n\t\t\tself.compare1.selected = false;\n\t\t\tself.compare1 = undefined;\n\t\t}\n\t\tif (self.compare2 != undefined){\n\t\t\tself.compare2.selected = false;\n\t\t\tself.compare2 = undefined;\n\t\t}\n\t\tMapsService.drawMap(self.cities, self.currentRegion, 'map-canvas');\n\t};\n\n\t// handles sorting of city table\n\tthis.doSort = function(index){\n\t\tif (self.sortOrder == self.sortOrderItems[index]){\n\t\t\tif (self.sortOrder.indexOf('+') != -1){\n\t\t\t\t// switch current column to sort desc\n\t\t\t\tself.sortOrder = self.sortOrder.replace('+','-');\n\t\t\t} else {\n\t\t\t\t// switch current column to sort asc\n\t\t\t\tself.sortOrder = self.sortOrder.replace('-','+');\n\t\t\t}\n\t\t} else {\n\t\t\t// order by new column asc\n\t\t\tself.sortOrder = self.sortOrderItems[index];\n\t\t}\n\t\tdocument.getElementById('cityTable').scrollTop = 0;\n\t};\n\n\n\t// compare functionality between 2 cities\n\t// - calculates distance between cities to then be combined with humidity to find dryline\n\tthis.selectCity = function(city){\n\t\tif (!city.selected){\n\t\t\tcity.selected = true;\n\t\t\t// set compared city\n\t\t\tif (self.compare1 == undefined){\n\t\t\t\tself.compare1 = city;\n\t\t\t} else {\n\t\t\t\tif (self.compare2 != undefined)\n\t\t\t\t\tself.compare2.selected = false;\n\t\t\t\tself.compare2 = city;\n\t\t\t}\n\n\t\t\t// if two cities are selected then compute distance\n\t\t\tif (self.compare1 != undefined && self.compare2 != undefined){\n\t\t\t\tself.kmDistance = ConversionsService.getCoordinatesToDistance(self.compare1.coord.lat, self.compare1.coord.lon, self.compare2.coord.lat, self.compare2.coord.lon);\n\t\t\t\tself.message = \"Distance from \"+self.compare1.name+\" to \"+self.compare2.name+\" is \"+Math.round(self.kmDistance,2)+\" km\";\n\t\t\t}\n\t\t} else {\n\t\t\tcity.selected = false;\n\t\t\tself.kmDistance = 0;\n\t\t\tself.kmDistanceText = \"\";\n\t\t\t// clear city out of compare\n\t\t\tif (self.compare1 != undefined){\n\t\t\t\tif (self.compare1.name == city.name)\n\t\t\t\t\tself.compare1 = undefined;\n\t\t\t}\n\t\t\tif (self.compare2 != undefined){\n\t\t\t\tif (self.compare2.name == city.name)\n\t\t\t\t\tself.compare2 = undefined;\n\t\t\t}\n\t\t\tif (self.compare1 == undefined || self.compare2 == undefined)\n\t\t\t\tself.message = \"\";\n\t\t}\n\t};\n\n\tthis.selectDryline = function(){\n\t\tvar drylineValues = DrylineService.calculateDrylineValues(self.cities, self.currentRegion);\n\t\tif (drylineValues[0].cityBHumidity > drylineValues[0].cityAHumidity)\n\t\t\tself.message = 'Greatest dryline between '+drylineValues[0].cityA+' ('+drylineValues[0].cityAHumidity+'%) and '+drylineValues[0].cityB+' ('+drylineValues[0].cityBHumidity+'%)';\n\t\telse\n\t\t\tself.message = 'Greatest dryline between '+drylineValues[0].cityB+' ('+drylineValues[0].cityBHumidity+'%) and '+drylineValues[0].cityA+' ('+drylineValues[0].cityAHumidity+'%)';\n\t\t\t\n\t};\n}\n\n// -- Function defining FirebaseFeedService\n// input : $q promise\nfunction FirebaseFeedService(FirebaseDataService, MapsService){\n\tvar self = this;\n\n\t// public functions\n\tthis.feed = function($scope, callback){\n\t\tvar arrCities = [];\n\n\t\tvar callbackFullDataset = function(message){\n\t\t\t// convert obj to array\n                        Object.keys(message).forEach(function(key) {\n                                arrCities.push(message[key]);\n                        });\n\n                        callback.cities = arrCities;\n\t\t\tMapsService.drawMap(arrCities, callback.currentRegion, 'map-canvas');\n\t\t};\n\t\tFirebaseDataService.getFullDataset(callbackFullDataset);\n\n\t\tvar callbackUpdates = function(message){\n\t\t\tfor (let i = 0;i < arrCities.length;i++){\n                                if (message.name == arrCities[i].name){\n                                        $scope.$apply(function(){\n                                                arrCities[i] = message;\n                                                document.getElementById('map-canvas').innerHTML = '';\n\t\t\t\t\t\tMapsService.drawMap(arrCities, callback.currentRegion, 'map-canvas');\n                                        });\n                                }\n                        }\n\t\t};\n\t\tFirebaseDataService.getUpdates(callbackUpdates);\n\t};\n}\n\n// -- Function to calculate drylines\n// input: ConversionService\n// output:\nfunction DrylineService(ConversionsService, ToolsService){\n\n\t// calculates the difference in humidity between two cities as compared to the distance between them\n\tthis.calculateDrylineValues = function(cities, region){\n\t\tvar drylineValues = [];\n\t\tfor (let i = 0; i < cities.length; i++){\n\t\t\tfor (let j = 0; j < cities.length;j++){\n\t\t\t\tif (cities[i].name != cities[j].name && cities[i].region == cities[j].region && cities[i].region == region){\n\t\t\t\t\tvar kmDistance = ConversionsService.getCoordinatesToDistance(cities[i].coord.lat, cities[i].coord.lon, cities[j].coord.lat, cities[j].coord.lon);\n\t\t\t\t\tvar humidityDiff = cities[i].main.humidity - cities[j].main.humidity;\n\t\t\t\t\tif (humidityDiff != 0){\n\t\t\t\t\t\tif (humidityDiff < 0)\n\t\t\t\t\t\t\thumidityDiff = humidityDiff * -1;\n\t\t\t\t\t\tdrylineValues.push({\n\t\t\t\t\t\t\tregion : cities[i].region,\n\t\t\t\t\t\t\tcityA : cities[i].name,\n\t\t\t\t\t\t\tcityB : cities[j].name,\n\t\t\t\t\t\t\tcityAHumidity : cities[i].main.humidity,\n\t\t\t\t\t\t\tcityBHumidity : cities[j].main.humidity,\n\t\t\t\t\t\t\tdelta : humidityDiff / kmDistance\n\t\t\t\t\t\t});\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdrylineValues = ToolsService.sortByAttribute(drylineValues, 'delta', 'desc');\n\t\treturn drylineValues;\n\t}\n}\n\n// -- Function defining TemperatureFilter\n// input : ref to ConversionService\n// output : \nfunction TemperatureFilter(ConversionsService){\n\treturn function(kelvin){\n\t\treturn ConversionsService.getTemperatureKelvinToFahrenheit(kelvin);\n\t};\n}\n\n// -- Function defining WindDirectionFilter\n// input : ref to ConversionService\n// output :\nfunction WindDirectionFilter(ConversionService){\n\treturn function(deg){\n\t\treturn ConversionService.getWindDirectionDegToText(deg);\n\t};\n}\n\n})(); // END IIFE\n"]}