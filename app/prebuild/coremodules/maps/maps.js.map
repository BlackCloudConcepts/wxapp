{"version":3,"sources":["app/coremodules/maps/maps.js"],"names":[],"mappings":"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","file":"app/coremodules/maps/maps.js","sourcesContent":["'use strict';\n(function(){ // START IIFE\n\nangular.module('wxApp.coremodules.maps', ['wxApp.coremodules.conversions', 'wxApp.coremodules.wxattributes', 'wxApp.coremodules.tools'])\n.service('MapsService', MapsService);\nMapsService.$inject = ['ConversionsService', 'WxAttributesService', 'ToolsService'];\n\nfunction MapsService(ConversionsService, WxAttributesService, ToolsService){\n\n\t// generic mapping function to route to appropriate service\n\t// input: arrCities - array of cities and their related data\n        //      : currentRegion - current region of cities to limit list to and focus map on\n        //      : containerId - div to put the map in   \n\tthis.drawMap = function(arrCities, currentRegion, containerId){\n\t\tthis.drawGoogleMap(arrCities, currentRegion, containerId);\n\t}\n\n/*\n\t// draws open layer map \n\t// input: arrCities - array of cities and their related data\n        //      : currentRegion - current region of cities to limit list to and focus map on\n        //      : containerId - div to put the map in   \n\tthis.drawOpenLayerMap = function(arrCities, currentRegion, containerId){\n\t\t// filter out cities by region\n                var arr = [];\n                for (var i = 0;i < arrCities.length; i++){\n                        if (arrCities[i].region == currentRegion){\n                                arr.push(arrCities[i]);\n                        }\n                }\n                arrCities = arr;\n\n\t\t// http://www.peterrobins.co.uk/it/olchangingprojection.html\n\t\t//Maps Center \n\t\tvar lat = arrCities[0].coord.lat; \n\t\tvar lon = arrCities[0].coord.lon;\nconsole.log(lat);\nconsole.log(lon);\n//\t\tlat = 7486473;\n//\t\tlon = 4193332;\n\t\tvar lonlat = new OpenLayers.LonLat(lon, lat);\n\t    \tvar map = new OpenLayers.Map(containerId);\n\n\n\t\t// Create overlays\n\n\t\t// OSM layer\n\t    \tvar mapnik = new OpenLayers.Layer.OSM();\n\t\t// stations layer\n\t\tvar stations = new OpenLayers.Layer.Vector.OWMStations(\"Stations\");\n\t\t// weather layer\n\t\tvar city = new OpenLayers.Layer.Vector.OWMWeather(\"Weather\");\n\n\t\t//connect layers to map\n\t\tmap.addLayers([mapnik, stations, city]);\n\n\t\t//Add Layers swither\n\t\tmap.addControl(new OpenLayers.Control.LayerSwitcher());       \t\n\n\t\tmap.setCenter( lonlat, 10 );\n\n\t\t// Add popups \n\t\tvar selectControl = new OpenLayers.Control.SelectFeature([city,stations]);\n\t\tmap.addControl(selectControl);\n\t\tselectControl.activate(); \n\t}\n*/\n\n\t// draws google map with markers and popups for indicated locations\n\t// input: arrCities - array of cities and their related data\n\t//      : currentRegion - current region of cities to limit list to and focus map on\n\t//      : containerId - div to put the map in\t\n\tthis.drawGoogleMap = function(arrCities, currentRegion, containerId){\n\t\t// filter out cities by region\n\t\tvar arr = [];\n\t\tfor (var i = 0;i < arrCities.length; i++){\n\t\t\tif (arrCities[i].region == currentRegion){\n\t\t\t\tarr.push(arrCities[i]);\n\t\t\t}\n\t\t}\n\t\tarrCities = arr;\n\n\t\t// draw map\n\t\tvar mapOptions = {\n\t\t\tcenter: { lat: arrCities[0].coord.lat, lng: arrCities[0].coord.lon},\n\t\t\tzoom: 8\n\t\t};\n\t\tvar map = new google.maps.Map(document.getElementById(containerId), mapOptions);\n\t\n\t\t// add dryline layers\n\t\t// - http://geojson.org/geojson-spec.html#linestring\t\n\t\tvar drylineValues = WxAttributesService.calculateDrylineValues(arrCities, currentRegion);\n//\t\tvar drylineCoordinates1 = [[[drylineValues[0].cityACoord.lon, drylineValues[0].cityACoord.lat], [drylineValues[0].cityBCoord.lon, drylineValues[0].cityBCoord.lat]]];\n//\t\tvar drylineCoordinates2 = [[[drylineValues[1].cityACoord.lon, drylineValues[1].cityACoord.lat], [drylineValues[1].cityBCoord.lon, drylineValues[1].cityBCoord.lat]]];\n//\t\tvar drylineCoordinates3 = [[[drylineValues[2].cityACoord.lon, drylineValues[2].cityACoord.lat], [drylineValues[2].cityBCoord.lon, drylineValues[2].cityBCoord.lat]]];\n//\n\t\t// highest delta dryline\n\t\tvar points = ToolsService.getPerpendicularLine(\n\t\t\t{lat:drylineValues[0].cityACoord.lat,lon:drylineValues[0].cityACoord.lon},\n\t\t\t{lat:drylineValues[0].cityBCoord.lat,lon:drylineValues[0].cityBCoord.lon}\n\t\t);\n\t\tvar drylineCoordinates1 = [[[points.pointA.lon, points.pointA.lat],[points.pointB.lon, points.pointB.lat]]];\n\t\t// 2nd\n\t\tvar points = ToolsService.getPerpendicularLine(\n\t\t\t{lat:drylineValues[1].cityACoord.lat,lon:drylineValues[1].cityACoord.lon},\n\t\t\t{lat:drylineValues[1].cityBCoord.lat,lon:drylineValues[1].cityBCoord.lon}\n\t\t);\n\t\tvar drylineCoordinates2 = [[[points.pointA.lon, points.pointA.lat],[points.pointB.lon, points.pointB.lat]]];\n\t\t// 3rd\n\t\tvar points = ToolsService.getPerpendicularLine(\n\t\t\t{lat:drylineValues[2].cityACoord.lat,lon:drylineValues[2].cityACoord.lon},\n\t\t\t{lat:drylineValues[2].cityBCoord.lat,lon:drylineValues[2].cityBCoord.lon}\n\t\t);\n\t\tvar drylineCoordinates3 = [[[points.pointA.lon, points.pointA.lat],[points.pointB.lon, points.pointB.lat]]];\n\t\tvar myData = {\n\t\t  \t\"type\": \"FeatureCollection\",\t\n\t\t \t\"features\": [\n\t\t    \t\t{\n\t\t      \t\t\t\"type\": \"Feature\",\n\t\t\t\t\t\"properties\": {\n\t\t\t\t\t\t\"delta\": drylineValues[0].delta,\n\t\t\t\t\t},\n\t\t\t\t      \t\"geometry\": {\n\t\t\t\t\t\t\"type\": \"MultiLineString\",\n\t\t\t\t\t\t\"coordinates\": drylineCoordinates1\n\t\t\t\t      \t},\n\t\t\t\t\t\"style\" : {\n\t\t\t\t\t\t\"strokeColor\" : \"green\",\n\t\t\t\t\t\t\"strokeWeight\" : 4\n\t\t\t\t\t}\n\t\t    \t\t},\n\t\t\t\t{\n\t\t      \t\t\t\"type\": \"Feature\",\n\t\t\t\t\t\"properties\": {\n\t\t\t\t\t\t\"delta\": drylineValues[1].delta,\n\t\t\t\t\t},\n\t\t\t\t      \t\"geometry\": {\n\t\t\t\t\t\t\"type\": \"MultiLineString\",\n\t\t\t\t\t\t\"coordinates\": drylineCoordinates2\n\t\t\t\t      \t},\n\t\t\t\t\t\"style\" : {\n\t\t\t\t\t\t\"strokeColor\" : \"green\",\n\t\t\t\t\t\t\"strokeWeight\" : 4\n\t\t\t\t\t}\n\t\t    \t\t},\n\t\t\t\t{\n                                        \"type\": \"Feature\",\n                                        \"properties\": {\n                                                \"delta\": drylineValues[2].delta,\n                                        },\n                                        \"geometry\": {\n                                                \"type\": \"MultiLineString\",\n                                                \"coordinates\": drylineCoordinates3\n                                        },\n                                        \"style\" : {\n                                                \"strokeColor\" : \"green\",\n                                                \"strokeWeight\" : 4\n                                        }\n                                },\n\t\t  \t]\n\t\t};\n\t\tmap.data.addGeoJson(myData);\n\t\tmap.data.setStyle(function(feature) {\n\t\t    \tvar delta = feature.getProperty('delta');\n\t\t\tvar color = 'blue';\n\t\t\tif (delta > 1)\n\t\t\t\tcolor = 'red';\n\t\t\telse if (delta > .75)\n\t\t\t\tcolor = 'orange';\n\t\t\telse if (delta > .5)\n\t\t\t\tcolor = 'yellow';\n\t\t\telse if (delta > .1)\n\t\t\t\tcolor = 'green';\n\t\t    \treturn {\n\t\t      \t\tstrokeColor: color,\n\t\t      \t\tstrokeWeight: 4\n\t\t    \t};\n\t\t});\n\n\t\t// add markers\n\t\tvar markers = {};\n\t\tfor (var i = 0;i < arrCities.length;i++){\n\t\t\t(function(){\n\t\t\t\tvar name = arrCities[i].name;\n\t\t\t\tvar temp = ConversionsService.getTemperatureKelvinToFahrenheit(arrCities[i].main.temp);\n\t\t\t\tvar pressure = arrCities[i].main.pressure;\n\t\t\t\tvar humidity = arrCities[i].main.humidity;\n\t\t\t\tvar windspeed = arrCities[i].wind.speed;\n\t\t\t\tvar winddirection = ConversionsService.getWindDirectionDegToText(arrCities[i].wind.deg);\n\t\t\t\tvar contentString = '<div id=\"content\" style=\"width:200px\">'+\n\t\t\t\t\t'<div id=\"bodyContent\">'+\n\t\t\t\t\t'<div>'+name+'</div>'+\n\t\t\t\t\t'<div style=\"font-size:8pt;\">Temperature: '+temp+' &deg;F</div>'+\n\t\t\t\t\t'<div style=\"font-size:8pt;\">Pressure: '+pressure+' mb</div>'+\n\t\t\t\t\t'<div style=\"font-size:8pt;\">Humidity: '+humidity+' %</div>'+\n\t\t\t\t\t'<div style=\"font-size:8pt;\">Wind Speed: '+windspeed+' km/h</div>'+\n\t\t\t\t\t'<div style=\"font-size:8pt;\">Wind Direction: '+winddirection+'</div>'+\n\t\t\t\t\t'</div>'+\n\t\t\t\t\t'</div>';\n\n\t\t\t\tvar infowindow = new google.maps.InfoWindow({\n\t\t\t\t\tcontent: contentString\n\t\t\t\t});\n\n\t\t\t\tvar lat = arrCities[i].coord.lat;\n\t\t\t\tvar lon = arrCities[i].coord.lon;\n\t\t\t\tvar marker = new google.maps.Marker({\n\t\t\t\t\tposition: new google.maps.LatLng(lat,lon),\n\t\t\t\t\tmap: map,\n\t\t\t\t\ttitle:name,\n\t\t\t\t\ticon:'http://cdnimages.magicseaweed.com/30x30/5.png'\n\t\t\t\t});\n\t\t\t\tmarkers[i] = marker;\n\t\t\t\tvar x = i;\n\t\t\t\tgoogle.maps.event.addListener(marker, 'click', function() {\n\t\t\t\t\tinfowindow.open(map,markers[x]);\n\t\t\t\t});\n\t\t\t})();\n\t\t}\n\t}\n       \n}\n\n}\n)(); // END IIFE\n"]}